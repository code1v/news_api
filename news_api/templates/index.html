<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Indian News App</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container my-4">
    <h1 class="text-center mb-4">üì∞ News App</h1>

    <!-- Top Search Bar -->
    <div class="input-group mb-3 w-50 mx-auto">
      <input type="text" id="searchQuery" class="form-control" placeholder="Search news (e.g. cricket, bollywood, startup)">
      <button class="btn btn-outline-primary" onclick="searchNews()">Search</button>
      <button class="btn btn-success ms-2" onclick="fetchTopHeadlines()">Top Headlines</button>
    </div>

    <div id="news-container" class="row g-3"></div>
  </div>

  <script>
    async function fetchTopHeadlines() {
      const response = await fetch(`/news?query=india`);
      const data = await response.json();
      renderNews(data.articles);
    }

    async function searchNews() {
      const query = document.getElementById("searchQuery").value;
      if (!query.trim()) return;
      const response = await fetch(`/news?query=${query}`);
      const data = await response.json();
      renderNews(data.articles);
    }

    function renderNews(articles) {
      const container = document.getElementById("news-container");
      container.innerHTML = "";

      if (articles.length === 0) {
        container.innerHTML = `<p class="text-center text-danger">‚ùå No news found</p>`;
        return;
      }

      articles.forEach(article => {
        const col = document.createElement("div");
        col.className = "col-md-4";
        col.innerHTML = `
          <div class="card h-100 shadow-sm">
            ${article.image ? `<img src="${article.image}" class="card-img-top" alt="News Image">` : ""}
            <div class="card-body">
              <h5 class="card-title">${article.title || "No title"}</h5>
              <p class="card-text">${article.description}</p>
              <a href="/article?title=${encodeURIComponent(article.title)}&content=${encodeURIComponent(article.full_text)}&image=${encodeURIComponent(article.image || '')}" target="_blank" class="btn btn-sm btn-primary">Read More</a>
            </div>
          </div>
        `;
        container.appendChild(col);
      });
    }

    // Load headlines on start
    fetchTopHeadlines();
  </script>
</body>
</html>
